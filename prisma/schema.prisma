generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model address {
  id       Int     @default(autoincrement()) @id
  userId   Int?
  address1 String
  address2 String?
  user     user?   @relation("address_userIdTouser", fields: [userId], references: [id])
  users    user[]  @relation("addressTouser_defaultAddressId")

  @@index([userId], name: "address_user_id")
}

model cart {
  userId    Int
  productId Int
  quantity  Int      @default(1)
  addedAt   DateTime @default(now())
  product   product  @relation(fields: [productId], references: [id])
  user      user     @relation(fields: [userId], references: [id])

  @@id([userId, productId])
  @@index([userId], name: "fkIdx_40")
  @@index([productId], name: "fkIdx_43")
}

model jjim {
  userId    Int
  productId Int
  addedAt   DateTime @default(now())
  product   product  @relation(fields: [productId], references: [id])
  user      user     @relation(fields: [userId], references: [id])

  @@id([userId, productId])
  @@index([userId], name: "fkIdx_33")
  @@index([productId], name: "fkIdx_36")
}

model product {
  id           Int      @default(autoincrement()) @id
  name         String   @default("")
  defaultPrice Int
  discount     Int
  price        Int
  category     String
  img          String
  createdAt    DateTime @default(now())
  carts        cart[]
  jjims        jjim[]

  @@index([category], name: "category_index")
  @@index([price], name: "price_index")
}

model user {
  id               Int       @default(autoincrement()) @id
  name             String    @default("")
  phone            String    @default("")
  email            String    @unique
  createdAt        DateTime  @default(now())
  defaultAddressId Int?
  address          address?  @relation("addressTouser_defaultAddressId", fields: [defaultAddressId], references: [id])
  addresses        address[] @relation("address_userIdTouser")
  carts            cart[]
  jjims            jjim[]

  @@index([defaultAddressId], name: "user_address_id")
}
